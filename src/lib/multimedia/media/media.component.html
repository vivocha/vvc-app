<!-- closed state -->
<div class="media-connected-view animated fadeInUp" *ngIf="context.isClosed">
  <div class="media-content" >
    <div class="media-title" [innerHtml]=" 'STRINGS.VOICE.CONTACT_CLOSED' | translate"></div>
  </div>
</div>
<!-- offering state -->
<div class="media-connected-view animated fadeInUp" *ngIf="(!context.isClosed && context.isOffering)">
  <div class="media-content" >
    <div class="media-title" [innerHtml]=" 'STRINGS.VOICE.MEDIA_OFFERING' | translate:{ nickname: context.agent.nick }"></div>
    <div class="media-avatar" *ngIf="context.agent.avatar">
      <img [src]="context.agent.avatar">
    </div>
    <div class="media-loading">
      <div class="inner-loading-panel">
        <div class="loading-container">
          <div class="progress-bar">
            <div class="loaded"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- incoming state -->
<div class="media-connected-view animated fadeInUp" *ngIf="(!context.isClosed && context.incomingOffer)">
  <div class="media-content" >
    <div class="media-title" [innerHtml]=" 'STRINGS.VOICE.INCOMING_MESSAGE' | translate:{ nickname: context.agent.nick }"></div>
    <div class="media-avatar" *ngIf="context.agent.avatar">
      <img [src]="context.agent.avatar">
    </div>
    <div class="media-tools fit incoming">
      <div class="button-wrapper">
        <div class="round-button hangup" (click)="rejectIncomingOffer()">
         <svg height="8" viewBox="0 0 22 8" width="22" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd" transform="translate(-1 -8)"><path d="m0 0h24.000001v24.000001h-24.000001zm0 0h24.000001v24.000001h-24.000001z"/><path d="m7.83689909 10.3913551v2.7170978c0 .3458124-.19583633.6360478-.48643218.7842532-.94127785.4631416-1.8257 1.0806639-2.61536263 1.8525666-.34745156.3396372-.91600865.3396372-1.26346021 0l-2.21105536-2.1613277c-.34745156-.3396373-.34745156-.8954073 0-1.2350445 5.93194567-5.79853359 15.54687789-5.79853359 21.47882349 0 .3474516.3396372.3474516.8954072 0 1.2350445l-2.204738 2.1551525c-.3474516.3396372-.9160087.3396372-1.2634602 0-.7833454-.7657275-1.6740848-1.389425-2.6153627-1.8525667-.2969131-.1420301-.4927494-.4446159-.4927494-.7780779v-2.7170978c-2.7038049-.85218066-5.6287153-.85835588-8.32620281 0z" class="fill" fill-rule="nonzero"/></g></svg>
        </div>
        <div class="button-label">{{ 'STRINGS.MEDIA.DECLINE' | translate }}</div>
      </div>

      <div class="button-wrapper">
        <div class="round-button"
             (click)="acceptOffer()">
          <svg *ngIf="context.incomingMedia === 'Video'" height="12" viewBox="0 0 18 12" width="18" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd" transform="translate(-3 -6)"><path d="m0 0h24v24h-24z"/><path d="m17 10.5v-3.5c0-.55-.45-1-1-1h-12c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11z" class="fill" fill-rule="nonzero"/></g></svg>
          <svg *ngIf="context.incomingMedia === 'Voice'" height="18" viewBox="0 0 18 18" width="18" xmlns="http://www.w3.org/2000/svg"><path d="m17.38 10.79-2.2-2.2c-.28-.28-.36-.67-.25-1.02.37-1.12.57-2.32.57-3.57 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 9.39-7.61 17-17 17-.55 0-1-.45-1-1v-3.49c0-.55.45-1 1-1 1.24 0 2.45-.2 3.57-.57.35-.12.75-.03 1.02.24l2.2 2.2c2.83-1.45 5.15-3.76 6.59-6.59z" class="fill" transform="translate(-3 -3)"/></svg>
        </div>
        <div class="button-label">{{ 'STRINGS.MEDIA.ACCEPT' | translate }}</div>
      </div>
    </div>
  </div>
</div>

<!-- connected state -->
<div class="media-connected-view animated fadeInUp" *ngIf="!context.isClosed && context.isMediaConnected">

  <div class="media-content" >
    <div class="media-title" *ngIf="!(context.videoRxStream || context.videoTxStream)" [innerHtml]=" 'STRINGS.VOICE.WELCOME_MESSAGE' | translate:{ nickname: context.agent.nick }"></div>

    <div class="media-avatar" *ngIf="context.agent.avatar && !(context.videoRxStream || context.videoTxStream)">
      <img [src]="context.agent.avatar">
    </div>

    <audio autoplay
           *ngIf="context.voiceRxStream"
           [srcObject]="context.voiceRxStream"></audio>


    <div class="media-video-wrapper">
      <video class="big-video"
             autoplay
             (click)="switchVideo = !switchVideo"
             [ngClass]="{'switch-enabled': this.context.screenRxStream && this.context.videoRxStream, 'flipped': isFlipped()}"
             *ngIf="isVideoVisible('big')"
             [srcObject]="getSrcForVideo('big')"></video>

      <!--
      <div class="big-video no-remote" *ngIf="!context.videoRxStream && context.videoTxStream"></div>
      -->

      <div class="small-video local"
           [ngClass]="{ 'hide': hideLocalVideo }"
           (mouseover)="hideLocalVideo=true"
           (mouseleave)="hideLocalVideo=false">
        <video autoplay
               muted
               *ngIf="isVideoVisible('local')"
               [srcObject]="getSrcForVideo('local')"></video>
      </div>

      <div class="small-video remote"
           [ngClass]="{ 'hide': hideRemoteVideo }"
           (mouseover)="hideRemoteVideo=true"
           (mouseleave)="hideRemoteVideo=false">
        <video autoplay
               muted
               *ngIf="isVideoVisible('remote')"
               [srcObject]="getSrcForVideo('remote')"></video>
      </div>
    </div>


    <div class="media-tools fit" *ngIf="isMediaToolbarVisible()">
      <div class="button-wrapper">
        <div class="round-button"
             *ngIf="!context.isMuted"
             (click)="toggleMute()">
          <svg height="19" viewBox="0 0 14 19" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m12 14c1.66 0 2.99-1.34 2.99-3l.01-6c0-1.66-1.34-3-3-3s-3 1.34-3 3v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1s-5.3-2.1-5.3-5.1h-1.7c0 3.41 2.72 6.23 6 6.72v3.28h2v-3.28c3.28-.48 6-3.3 6-6.72z" class="fill" transform="translate(-5 -2)"/></svg>
        </div>
        <div *ngIf="!context.isMuted" class="button-label">{{ 'STRINGS.MEDIA.UNMUTED' | translate }}</div>
        <div class="round-button"
             *ngIf="context.isMuted"
             (click)="toggleMute()">
          <svg height="19" viewBox="0 0 18 19" width="18" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd" transform="translate(-3 -2)"><path d="m0 0h24v24h-24zm0 0h24v24h-24z"/><path d="m19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17v-6c0-1.66-1.34-3-3-3s-3 1.34-3 3v.18zm-10.71-8.17-1.27 1.27 6.01 6.01v.72c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1h-1.7c0 3.41 2.72 6.23 6 6.72v3.28h2v-3.28c.91-.13 1.77-.45 2.54-.9l4.19 4.18 1.27-1.27z" class="fill" fill-rule="nonzero"/></g></svg>
        </div>
        <div *ngIf="context.isMuted" class="button-label">{{ 'STRINGS.MEDIA.MUTED' | translate }}</div>
      </div>
      <div class="button-wrapper">
        <div class="round-button"
             *ngIf="!context.videoTxStream"
             (click)="toggleVideo()">
          <svg height="19" viewBox="0 0 19 19" width="19" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd" transform="translate(-2 -2)"><path d="m0 0h24v24h-24zm0 0h24v24h-24z"/><path d="m21 6.5-4 4v-3.5c0-.55-.45-1-1-1h-6.18l11.18 11.18zm-17.73-4.5-1.27 1.27 2.73 2.73h-.73c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18l3.19 3.18 1.27-1.27z" class="fill" fill-rule="nonzero"/></g></svg>
        </div>
        <div *ngIf="!context.videoTxStream" class="button-label">{{ 'STRINGS.MEDIA.VIDEO_DISABLED' | translate }}</div>
        <div class="round-button"
             *ngIf="context.videoTxStream"
             (click)="toggleVideo()">
          <svg height="12" viewBox="0 0 18 12" width="18" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd" transform="translate(-3 -6)"><path d="m0 0h24v24h-24z"/><path d="m17 10.5v-3.5c0-.55-.45-1-1-1h-12c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11z" class="fill" fill-rule="nonzero"/></g></svg>
        </div>
        <div *ngIf="context.videoTxStream" class="button-label">{{ 'STRINGS.MEDIA.VIDEO_ENABLED' | translate }}</div>
      </div>

      <div class="button-wrapper">
        <div class="round-button hangup" (click)="hangup()">
          <svg height="8" viewBox="0 0 22 8" width="22" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd" transform="translate(-1 -8)"><path d="m0 0h24.000001v24.000001h-24.000001zm0 0h24.000001v24.000001h-24.000001z"/><path d="m7.83689909 10.3913551v2.7170978c0 .3458124-.19583633.6360478-.48643218.7842532-.94127785.4631416-1.8257 1.0806639-2.61536263 1.8525666-.34745156.3396372-.91600865.3396372-1.26346021 0l-2.21105536-2.1613277c-.34745156-.3396373-.34745156-.8954073 0-1.2350445 5.93194567-5.79853359 15.54687789-5.79853359 21.47882349 0 .3474516.3396372.3474516.8954072 0 1.2350445l-2.204738 2.1551525c-.3474516.3396372-.9160087.3396372-1.2634602 0-.7833454-.7657275-1.6740848-1.389425-2.6153627-1.8525667-.2969131-.1420301-.4927494-.4446159-.4927494-.7780779v-2.7170978c-2.7038049-.85218066-5.6287153-.85835588-8.32620281 0z" class="fill" fill-rule="nonzero"/></g></svg>
        </div>
        <div class="button-label">{{ 'STRINGS.MEDIA.CLOSE_CALL' | translate }}</div>
      </div>
    </div>
  </div>
  <div class="media-bottom animated slideInLeft">
    <div class="chat-button"
         (click)="displayChat.emit()">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="20" viewBox="0 0 20 20" width="34"><defs><path id="a" d="m20 2h-16c-1.1 0-1.99.9-1.99 2l-.01 18 4-4h14c1.1 0 2-.9 2-2v-12c0-1.1-.9-2-2-2zm-14 7h12v2h-12zm8 5h-8v-2h8zm4-6h-12v-2h12z"/><mask id="b" fill="#fff"><use fill="none" xlink:href="#a"/></mask></defs><g fill="none" fill-rule="evenodd" transform="translate(-2 -2)"><path d="m0 0h24v24h-24z"/><use fill="#FFF" fill-rule="nonzero" xlink:href="#a"/><g fill="#fff" fill-rule="evenodd" mask="url(#b)"><path d="m0 0h24v24h-24z"/></g></g>
        <circle *ngIf="context.notRead > 0" fill="#D7293B" cx="21" cy="5" r="5"></circle>
      </svg>
      <span>{{ 'STRINGS.VOICE.OPEN_CHAT' | translate }}</span>
    </div>
  </div>
</div>
